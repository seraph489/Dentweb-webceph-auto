# Dentweb-WebCeph Auto Processor

🦷 **덴트웹-웹셉 연결 자동화 프로그램**

덴트웹과 Web Ceph 플랫폼을 연동하여 치과 의료진을 위한 완전 자동화 솔루션입니다. 덴트웹에서 환자 정보를 자동 추출하고, Web Ceph에서 X-ray 및 얼굴 사진을 업로드하여 분석한 후 결과 PDF를 다운로드하는 전 과정을 자동화합니다.

## ✨ 주요 기능

### 🔄 완전 자동화 프로세스
- **환자 등록**: 환자 정보를 Web Ceph에 자동 등록
- **이미지 업로드**: X-ray와 얼굴 사진을 자동으로 분류하여 업로드
- **분석 실행**: 업로드 완료 후 자동으로 분석 시작
- **결과 다운로드**: 분석 완료 시 PDF 자동 다운로드 및 정리

### 🤖 Upstage OCR 기능 (개선됨)
- **공식 API 지원**: Upstage 공식 문서에 맞춘 OCR API 연동
- **스크린샷 캡처**: 덴트웹 화면의 지정된 영역 자동 캡처
- **환자 정보 추출**: 이름, 생년월일, 등록번호 자동 추출
- **OCR 테스트 기능**: 실시간 테스트 및 결과 확인 가능
- **오류 처리**: 상세한 API 응답 상태 및 오류 메시지 제공

### 📊 스마트 데이터 관리
- **Airtable 연동**: 환자 정보와 분석 결과 메타데이터 자동 저장
- **로컬 백업**: 모든 이미지와 PDF를 체계적으로 로컬 백업
- **통계 대시보드**: 일일/월별 처리 현황 실시간 모니터링

### 🎯 사용자 친화적 인터페이스
- **직관적인 UI**: 깔끔하고 전문적인 한국어 인터페이스
- **실시간 진행 상황**: 자동화 프로세스의 각 단계를 실시간 표시
- **오류 처리**: 문제 발생 시 즉각적인 피드백과 해결 방안 제시

## 🚀 시작하기

### 시스템 요구사항

- **운영체제**: Windows 10/11 (64bit)
- **메모리**: 최소 4GB RAM 권장
- **저장공간**: 500MB 이상
- **네트워크**: 안정적인 인터넷 연결
- **해상도**: 1920x1080 이상 권장

### 설치 방법

1. **실행 파일 다운로드**
   ```
   WebCephAuto_Setup_v1.0.0.exe 다운로드 및 실행
   ```

2. **설치 마법사 따라하기**
   - 설치 경로 선택
   - 바탕화면 아이콘 생성 (선택)
   - 설치 완료

3. **초기 설정**
   - **Upstage OCR API 키 입력** (필수)
   - Web Ceph 계정 정보 입력
   - Airtable API 설정 (선택)
   - 폴더 경로 설정

## 📖 사용 방법

### 1. Upstage OCR API 설정 (중요)

```
1. 설정 > API 설정 메뉴 이동
2. Upstage API 키 입력
3. "연결 테스트" 버튼으로 API 상태 확인
4. 정상 연결 확인 후 저장
```

### 2. OCR 기능 테스트

```
1. 환자 정보 입력 탭 이동
2. "🔍 OCR 테스트" 버튼 클릭
3. 캡처할 화면 영역 설정 (x, y, 너비, 높이)
4. 테스트할 화면 준비 후 실행
5. 추출된 텍스트 결과 확인
```

### 3. 자동화 실행

```
1. 덴트웹 프로그램에서 환자 정보 화면 준비
2. "📷 Dentweb에서 가져오기" 버튼 클릭
3. 자동으로 환자 정보 추출 및 입력
4. 필요시 정보 수정
5. 이미지 선택 후 "⚡ 자동화 시작"
```

## 🔧 API 설정 가이드

### Upstage OCR API 키 발급

1. [Upstage Console](https://console.upstage.ai) 방문
2. 회원가입 후 로그인
3. Document AI > OCR 서비스 활성화
4. API 키 생성 및 복사
5. 프로그램 설정에서 API 키 입력

### API 테스트 방법

- **자동 테스트**: 설정 화면에서 "연결 테스트" 버튼 사용
- **실제 OCR 테스트**: 환자 정보 화면에서 "OCR 테스트" 기능 활용
- **상태 확인**: 대시보드에서 실시간 API 상태 모니터링

## 🔍 문제 해결

### OCR 관련 문제

**Q: OCR API 연결이 실패합니다**
- API 키가 올바른지 확인
- Upstage 계정 상태 및 사용량 확인
- 네트워크 연결 상태 확인

**Q: OCR 텍스트 추출이 정확하지 않습니다**
- 스크린샷 영역 좌표 재조정
- 화면 해상도 및 확대율 확인
- 덴트웹 화면의 텍스트가 명확한지 확인

**Q: 스크린샷이 제대로 촬영되지 않습니다**
- 스크린샷 권한 확인
- 화면 보호기 또는 잠금 상태 해제
- 다른 프로그램이 화면을 가리고 있는지 확인

### 일반적인 문제

**Q: 프로그램이 시작되지 않습니다**
- Windows Defender 예외 처리 확인
- 관리자 권한으로 실행
- Python 런타임 설치 확인

**Q: 자동화 중 오류가 발생합니다**
- 로그 파일 확인: `%LOCALAPPDATA%\WebCephAuto\logs\`
- Web Ceph 사이트 접속 상태 확인
- 네트워크 연결 안정성 확인

## 📋 업데이트 로그

### v1.0.1 (최신)
- ✅ Upstage OCR API 공식 문서 기준으로 완전 재구현
- ✅ OCR 테스트 기능 추가 (실시간 결과 확인 가능)
- ✅ API 연결 테스트 기능 강화 (상세한 오류 메시지)
- ✅ 스크린샷 캡처 영역 설정 UI 개선
- ✅ API 키 암호화 저장 보안 강화
- ✅ 응답 처리 로직 다양한 API 버전 대응

### v1.0.0
- 🎉 초기 릴리스
- 기본 자동화 기능 구현
- Airtable 연동
- 대시보드 UI

## 🤝 지원 및 문의

- **이메일**: support@webcephauto.com
- **문서**: [사용자 가이드](./doc/)
- **이슈 리포트**: GitHub Issues

## 📄 라이선스

Copyright © 2024 Web Ceph Auto Team. All rights reserved. 
